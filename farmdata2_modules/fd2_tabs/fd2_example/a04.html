<body>
   <h1>Harvest Report</h1><br>
    <p>This page is a <i>mockup</i> of a form for generating harvest report.</p><br>
    <div id="fullReport" v-cloak>
     
    <label for="title">Title:</label>
    <input type="text" id="title" name="title" v-model="reportTitle">
    
    <br>

    <lable for="start">Start:</lable>
    <input type="date" id="start" name="start date" v-model="reportStartDate" min="2014-01-01" :max=reportEndDate>
    <label for="end">End:</label>
    <input type="date" id="end" name="end date" v-model="reportEndDate" :min=reportStartDate max="2022-01-01">
    
    <br>

    <label for="crop">Crop:</label>
    <select id="crop" name="crop" v-model="reportCrop">
        <option v-for="crop in Crops">{{crop}}</option>
    </select>
    <label for="field">Field:</label>
    <select id="field" name="field">
        <option v-for="field in Fields">{{field}}</option>
    </select>

    <br>

    <button type="button" @click="generateReport(); changeReportState('visible')">
        Generate Report
    </button>

    <hr>
    <div v-if="reportState==='visible'" class="reportSection">
    <h1>{{reportTitle=="" ? "Mock Harvest Report" : reportTitle}}</h1><br>
    
    <p>Details:</p>
    <ul>
        <li><Strong>Start:{{reportStartDate}}</Strong></li>
        <li><Strong>End:{{reportEndDate}}</Strong></li>
        <li><Strong>Crop:{{reportCrop}}</Strong></li>
    </ul>
    <br>

    <p v-if="harvestLogs.length===0">There are no matching records.</p>
    <table v-if="harvestLogs.length!==0" border=1>
        <tr>
            <th>Date</th>
            <th>Field</th>
            <th>Crop</th>
            <th>Yield</th>
            <th>Delete</th>
        </tr>
        <tr v-for="(data, dataIndex) in harvestLogs">
            <td>{{data.date}}</td>
            <td>{{data.field}}</td>
            <td>{{data.crop}}</td>
            <td>{{data.yield}}</td>
            <td>
                <button type="button" @click="deleteLog">Delete</button>
            </td>
        </tr>
    </table>
    <p>Total Yield:{{getTotalYield}}</p>
    </div>
    </div>
    <script>
        var report = new Vue({
            el: '#fullReport',
            data:{
                reportState: 'hidden',
                reportTitle: '',
                reportStartDate:'2018-05-01',
                reportEndDate:'2018-05-15',
                reportCrop:'Kale',
                Crops:['Broccoli','Kale','Peas'],
                Fields:['All','Chuau-1','SQ7'],
                harvestLogs:[]
            },
            
            computed:{
                getTotalYield(){
                    let yield=0;
                    for(let i=0; i<this.harvestLogs.length; i++){
                        let report=this.harvestLogs[i];
                        yield=yield+parseInt(report.yield.split(" ")[0]);
                    }
                    return yield;
                }
            },


            methods:{
                generateReport:function() {
                    if (this.harvestLogs.length==0){
                        this.harvestLogs.push({date: '05/03/2018', field: 'SQ7', crop: 'Broccoli', yield: '6 bunches'});
                    } else if(this.harvestLogs.length==1){
                        this.harvestLogs.push({date: '05/10/2018', field: 'All', crop: 'Peas', yield: '8 bunches'});
                    } else{

                    }
                },
                
                deleteLog:function(dataIndex){
                    this.harvestLogs.splice(dataIndex,1);
                },

                changeReportState:function(newState){
                    this.reportState=newState;
                }
            }
        });
        Vue.config.devtools = true;
    </script>
</body>
