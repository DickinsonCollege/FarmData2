<!-- define a div to wrqp around the app. -->
<!-- apply v-cloak so that app is not visible until after being rendered -->
<div id="ex1" v-cloak>

    <p>UserID: <span data-cy="user-id">{{ userID }}</span></p>
    <p>UserName: <span data-cy="user-name">{{ userName }}</span></p>

    <!-- Example of a v-model binding -->
    <p>Type comment: <input data-cy="comment-field" type='text' v-model='comment'>
    <p>Comment: <span data-cy="comment">{{ comment }}</span></p>

    <!-- Example of event handling and api call -->
    <p><button data-cy="get-name-button" @click='getFarmName'>Get Farm Name</button></p>
    <p>Farm Name: <span data-cy="farm-name">{{ farm }}</span></p>

    <!-- Exmaple of using a Vue Component -->
    <!-- the fields-dropdown component is defined in ../resources/fieldsDropDownComponent.js -->
     <!-- That file is imported by the fd2_example.info file -->
    <fields-dropdown @field-changed='fieldChange' :fields-list=fieldList></fields-dropdown>
    <p>Chosen Field: <span data-cy="selected-field">{{selectedField}}</span></p>
</div>

<script>
// Define the Vue instance for the app.
// el: must match the id of the <div> for the app above.
// Note: The JS variables fd2UserID and fd2UserName are defined in fd2_example.module
new Vue({
    el: '#ex1',
    components: {
        // Register the components that are being used.
        fieldsDropdown: fieldsDropdownComponent,
    },
    data: {
	    comment: null,
        farm: null,
        selectedField: null,
        fieldList: null,
        userID: fd2UserID,
        userName: fd2UserName,
    },
    created() {
        axios
        .get('/taxonomy_term.json?bundle=farm_areas')
        .then(response => {
            this.fieldList = response.data.list.map(
                function(f) { return f.name }
            );
            this.fieldList.sort();
            this.fieldList.unshift("All");
        })
        .catch(error => {
            this.fieldList = [ 'Server error' ]
            console.log(error)
        })
    },
    methods: {
        getFarmName() {
            axios
            .get('/farm.json')
            .then(response => (this.farm = response.data.name))
            .catch(error => console.log(error))
        },
        fieldChange(newField) {
            this.selectedField = newField;
        }
    }
});

Vue.config.devtools = true;
</script>