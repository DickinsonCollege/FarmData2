<body>
    <div id='seedingInput'>
       <h1>Seeding Input Log</h1> 
       <date-selection :default-date='selectedDate' @date-changed='setNewDate'>Date of Seeding:</date-selection>

       <br>

       <dropdown-with-all :dropdown-list='cropArray' @selection-changed='setNewCrop'>Crop:</dropdown-with-all>
       <dropdown-with-all :dropdown-list='areaArray' @selection-changed='setNewArea'>Area:</dropdown-with-all>

       <br>

       <input type='radio' name='typeOfSeeding' value='Tray Seedings' v-model='selectedSeedingType'><label>Tray Seedings</label>
       <input type='radio' name='typeOfSeeding' value='Direct Seedings' v-model='selectedSeedingType'> <label>Direct Seedings</label>

       <br>

       <div v-if='(selectedSeedingType=="Tray Seedings")'>
            <label>Number of Trays Planted: </label><input type=number v-model='numOfTrays'>
            <label>Cells per Tray: </label><input type=number v-model='numCellsPerTray'>
            <label>Number of Seeds Plants: </label><input type=number v-model='numSeedsPlanted'>
       </div>
       <div v-if='(selectedSeedingType=="Direct Seedings")'>
            <label>Rows per Bed: </label><input type=number v-model='numRowBed'>
            <div style='display: flex;'>
                <label>Number of Feet: </label><input type=number v-model='numFeet'><dropdown-with-all :dropdown-list='feetUnits' @selection-changed='setNewFeetUnit'>Units</dropdown-with-all>
            </div>
       </div>

       <br>

       <label>Number of Workers: </label><input type=number v-model='numWorkers'>
       <br>
       <div style='display: flex;'>
            <label>Time Spent: </label><input type=number v-model='time'>
            <dropdown-with-all :dropdown-list='timeUnits' @selection-changed='setNewTimeUnit'>Units:</dropdown-with-all>
       </div>
       <label>Comments: </label><textarea v-model='comments'></textarea>

       <button :disabled='formNotCompleted'>Submit</button>
    </div>

    <script>
        new Vue({
            el: '#seedingInput',
            components:{
                'date-selection': DateSelectionComponent,
                'dropdown-with-all': DropdownWithAllComponent
            },
            data:{
                selectedDate: dayjs().format('YYYY-MM-DD').toString(),
                selectedCrop: null,
                selectedArea: null,
                selectedSeedingType: '',
                selectedTimeUnit: null,
                selectedFeetUnit: null,
                comments: '',
                numWorkers: 0,
                time: 0, 
                numOfTrays: 0,
                numCellsPerTray: 0,
                numSeedsPlanted: 0,
                numRowBed: 0,
                numFeet: 0,
                cropArray: [],
                areaArray: [],
                timeUnits: ['minutes', 'hours'],
                feetUnits: ['row', 'bed'],
            },
            methods:{
                setNewDate(newDate){
                    this.selectedDate = newDate
                },
                setNewCrop(newCrop){
                    this.selectedCrop = newCrop
                },
                setNewArea(newArea){
                    this.selectedArea = newArea
                },
                setNewTimeUnit(newTimeUnit){
                    this.selectedTimeUnit = newTimeUnit
                },
                setNewFeetUnit(newFeetUnit){
                    this.selectedFeetUnit = newFeetUnit
                }
            },
            computed: {
                formNotCompleted(){
                    if(this.selectedCrop == null){
                        return true
                    }
                    if(this.selectedArea == null){
                        return true
                    }
                    if(this.selectedSeedingType == ''){
                        return true
                    }
                    if(this.selectedFeetUnit == null){
                        return true
                    }
                    if(this.selectedTimeUnit == null){
                        return true
                    }
                    if(this.time == 0){
                        return true
                    }
                    if(this.selectedSeedingType == 'Direct Seedings'){
                        if(this.numFeet == 0){
                            return true
                        }
                        if(this.numRowBed == 0){
                            return true
                        }
                    }
                    if(this.selectedSeedingType == 'Tray Seedings'){
                        if(this.numCellsPerTray == 0){
                            return true
                        }
                        if(this.numOfTrays == 0){
                            return true
                        }
                        
                        if(this.numSeedsPlanted == 0){
                            return true
                        }
                    }
                    if(this.numWorkers == 0){
                        return true
                    }
                    return false
                }
            },
            created(){
                let fullResponse = []
                getAllPages('/taxonomy_term.json?bundle=farm_crops',fullResponse).then(() => {
                    this.cropArray = fullResponse.map((h) => h.name)
                })
                getAllPages('/taxonomy_term.json?bundle=farm_areas', this.areaArray).then(() => {
                    this.areaArray = this.areaArray.map((h) => h.name)
                })
            }
        })
    Vue.config.devtools = true;
    </script>
</body>