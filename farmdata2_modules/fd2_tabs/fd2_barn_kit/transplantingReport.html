<div id="transplantUI" v-cloak> 

<!--fieldset groups together the heading, date input, and generate report button (styles are duplicated from the Seeding Report tab)-->
    <fieldset class="panel panel-default center-block" style="width: 50%;">
        <legend class="panel-heading" style="background-color: #d62a17; color: white;">Set Dates</legend>
        <div style="display: flex;width: 100%; padding: 7px">

        <!--This uses the dateRangeSelectionComponent defined in the FD2 Resources file - it defines the date input forms together.-->
            <date-range-selection data-cy="date-range-selection"
            class="center-block"  
            default-start-date="2021-01-15" :default-end-date=dateRangeMaxDate @start-date-changed="startDateChange" @end-date-changed="endDateChange" 
            >
            </date-range-selection>

            <!--Generate Report Button - uses the standard FD2 button style.-->
            <button data-cy="generate-rpt-btn" class="btn center-block btn-primary" @click="reportButtonClicked">Generate Report</button>
        </div>
     </fieldset>
       <!-- <p v-if="!reportDisplay">No transplanting logs were found for the selected date range.</p>-->
        <div v-if="reportDisplay">
            <table border=1>
                <tr>
                    <th>Crop</th>
                    <th>Field</th>
                    <th>Tray Seeding Date</th>
                    <th>Transpanting Date</th>
                    <th>Days in Tray</th>
                    <th>Bed Feet</th>
                    <th>Rows/Bed</th>
                    <th>Row Feet</th>
                    <th>Trays</th>
                    <th>Hours</th>
                    <th>Comments</th>
                    <th>User</th>
                </tr>
                <tr v-for="item in rows">
                    <td>{{item.crop}}</td>
                    <td>{{item.field}}</td>
                    <td>{{item.tray_date}}</td>
                    <td>{{item.transplant_date}}</td>
                    <td>{{item.days}}</td>
                    <td>{{item.bed_feet}}</td>
                    <td>{{item.rows_bed}}</td>
                    <td>{{item.row_feet}}</td>
                    <td>{{item.trays}}</td>
                    <td>{{item.hours}}</td>
                    <td>{{item.comments}}</td>
                    <td>{{item.user}}</td>
                    <td><button type="button" @click="deleteItem">Delete</button></td>
                </tr>    
            </table>
        </div>
     </fieldset>
     <!--Report table filters UI (uses the DropdownWithAllComponent defined in the fd2_tabs/resources directory) and the styles from the Seeding Report-->
     <fieldset class="center-block panel panel-default" style="width: 75%;">
        <legend class="panel-heading" style="background-color: #d62a17; color: white;">Filters</legend>
         <div style="display: flex; width: 100%;">
            <dropdown-with-all class="center-block" :dropdown-list=cropList includes-all default-input='All' @selection-changed="cropChange">Crop:</dropdown-with-all>
            <dropdown-with-all class="center-block" :dropdown-list=fieldList includes-all default-input='All' @selection-changed="areaChange">Area:</dropdown-with-all>
         </div>         
     </fieldset>
</div> 
<script>
    new Vue({
        el: '#transplantUI',
        components: {
            'date-range-selection': DateRangeSelectionComponent, 
            'dropdown-with-all': DropdownWithAllComponent               
        },
        data: {
            //variables for date range selection
            startDate: null,
            endDate: null,
            dateRangeClicks: 0,
            dateRangeMaxDate: dayjs().format("YYYY-MM-DD"),
            //display variables
            reportDisplay: false,
            //report table variables
            columns : ["Crop", "Field", "Tray Seeding Date", "Transpanting Date", "Days in Tray", "Bed Feet", "Rows/Bed", "Row Feet", "Trays", "Hours", "Comments", "User"],
            rows : [],
            //filter dropdown variables
            selectedCrop: "All",
            selectedArea: "All"
        },
        methods: {
            //methods for date range selection
            startDateChange: function(newDate) {
                this.startDate = newDate
                console.log(this.startDate)
            },
            endDateChange: function(newDate) {
                this.endDate = newDate
                console.log(this.startDate)
            },
            reportButtonClicked: function(){
                this.reportDisplay = true
                this.rows.push({crop: "BROCCOLI", field: "C", tray_date: "2022-03-08", transplant_date: "2022-04-05", days: '28', bed_feet: "400.0", rows_bed: "2", row_feet: "800.0", trays: "5", hours: ".02", comments: "", user: "nelsonw"})
            },   
            deleteItem: function(index){
                this.rows.splice(index, 1)
            },
            //methods for dropdown filters
            cropChange(selectedCrop){
                this.selectedCrop = selectedCrop
            },
            areaChange(selectedArea){
                this.selectedArea = selectedArea   
            }

        },
        computed: {
            //This should be replaced with a function that returns a sorted list of all of the available crops in the logs - this function is already written in seedingReport.html
            
            cropList(){
                //Sample list
                return ["BOKCHOY", "BROCCOLI", "CABBAGE"]
            },
            
            //This should be replaced with a function that returns a sorted list of all of the available fields in the logs - this function is already written in seedingReport.html
            
            fieldList(){
                //Sample list
                return ["GHANA-1", "CHUAU-4", "CHUAH-4"]
            }         
        }
    })
    Vue.config.devtools = true;
</script>
